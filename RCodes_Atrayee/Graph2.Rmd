---
title: "Graph2-Analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
# Load The Data:
qt2 <- data.table::fread(here::here("data", "Q1-Graph2.csv"))
head(qt2)
tail(qt2)

```

## Including Plots

You can also embed plots, for example:

```{r pressure}
# Summarising the Data:
summary(qt2)
nrow(qt2) #1300
ncol(qt2) #11
```

```{r}
# Differentiating between channels:
qt2_01 <- qt1 %>% filter(qt1$eType == 0 | qt1$eType == 1) # Communication Channel
nrow(qt2_01) # 318
qt2_23 <- qt1 %>% filter(qt1$eType == 2 | qt1$eType == 3) # Procurement Channel
nrow(qt2_23) # 14
qt2_4 <- qt1 %>% filter(qt1$eType == 4) # Co-authorship Channel
nrow(qt2_4) # 1
qt2_5 <- qt1 %>% filter(qt1$eType == 5) # Demographic Channel
nrow(qt2_5) # 846
qt2_6 <- qt1 %>% filter(qt1$eType == 6) # Travel Channel
nrow(qt2_6) # 37
```

```{r}
common_list <- NULL
for (i in qt2_01$Source) {
  for (j in qt2_23$Source) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt2_01$Source) {
  for (j in qt2_4$Source) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt2_01$Source) {
  for (j in qt2_5$Source) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt2_01$Source) {
  for (j in qt2_6$Source) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt2_01$Target) {
  for (j in qt2_23$Target) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt2_01$Target) {
  for (j in qt2_4$Target) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt2_01$Target) {
  for (j in qt2_5$Target) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt2_01$Target) {
  for (j in qt2_6$Target) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
common_list
length(common_list)
```

## Travel Channel:

```{r}
glimpse(qt2_6)
unique(qt2_6)
unique(qt2_6$eType) 
unique(qt2_6$SourceLocation) 
unique(qt2_6$TargetLocation) 
unique(qt2_6$SourceLatitude) 
unique(qt2_6$SourceLongitude) 
unique(qt2_6$TargetLatitude) 
unique(qt2_6$TargetLongitude) 
unique(qt2_6$Source)
unique(qt2_6$Target)
unique(qt2_6$Weight) 


range(qt2_6$Source) 
range(qt2_6$Target) 
range(qt2_6$Time) 
income_cat_qt1 <- NULL


hist(qt2_6$Weight)
unique(qt2_6$Weight) 
range(qt2_6$Weight) 
```

## Removing Duplicates:

```{r}
head(qt2_6)
qt2_6 <- subset(qt2_6, select = -c(SourceLatitude, SourceLongitude, TargetLatitude, TargetLongitude)) # SOurce and Target Latitude and Longitude columns removed as all Null.
qt2_6 %>% distinct(Source, etype, Target, Time, Weight, SourceLocation, TargetLocation)
nrow(qt2_6) #37
# No Duplicate rows in Travel Channel
```

## Each variable with it's Frequency Counts:

```{r}
target_count <- count(qt2_6, 'Target')
target_count #625756 509607 499467 561157 657173 616453
time_count <- count(qt2_6, 'Time')
time_count <- time_count %>% filter(time_count$freq > 1)
time_count #16486747 18214747 21152347 24608347 30137947 30224347
weight_count <- count(qt2_6, 'Weight')
weight_count #2,5,1,4,3
sourceloc_count <- count(qt2_6, 'SourceLocation')
sourceloc_count #3,2,(0,4),1,5
targetloc_count <- count(qt2_6, 'TargetLocation')
targetloc_count #3,4,2,0,1,5
```

## Extracting the top 3 most repeated values from each Column:

```{r}
target <- qt2_6 %>% filter(Target==625756 | Target==509607 | Target==499467 ) #24 vals; 
weight <- qt2_6 %>% filter(Weight==2 | Weight==5 | Weight==1 ) #27 vals; 
SLoc <- qt2_6 %>% filter(SourceLocation==0 | SourceLocation==2 | SourceLocation==3 ) #32; in order: 3,2,0
TLoc <- qt2_6 %>% filter(TargetLocation==3 | TargetLocation==2 | TargetLocation==0 | TargetLocation==4) #30; 
time <- qt2_6 %>% filter(Time==16486747 | Time==18214747 | Time==21152347 |Time==24608347 | Time==30137947 | Time==30224347 ) #12 
df1 <- rbind(target, weight, SLoc, TLoc, time)
nrow(df1) #117
df1 <- df1[!duplicated(df1), ]
nrow(df1) #37
head(df1)
unique(df1$Source) #13 People
```

## Target, Time, Weight:

```{r}
# Target:70
df1 %>% filter(Target==625756) #9 SourceLocation: 0 and 4
df1 %>% filter(Target==625756 & SourceLocation==4) #629627,534034,599441,585212,643925,649553
df1 %>% filter(Target==625756 & SourceLocation==0) #464459,568093,635665
```

## For Target=625756, 9 nodes are found
### 1. 3 groups based Source Location and Time
### 2. 629627,534034,599441,585212 come from Country 4 and have travelled within days of each other
### 3. 643925,649553 come from country 4 and have travelled within days of each other
### 4. 464459,568093,635665 come from country 0 and have travelled within days of each other

```{r}
# Target:499467
df1 %>% filter(Target==499467) #7 SourceLocation: 1 and 3
df1 %>% filter(Target==499467 & SourceLocation==1) #534034,629627,585212,599441
df1 %>% filter(Target==499467 & SourceLocation==3) #635665,464459,568093
```

## For Target=499467, 7 nodes are found
### 1. 3 groups based Source Location and Time
### 2. 534034,629627,585212,599441 come from Country 1 and have travelled within days of each other
### 3. 635665,464459,568093 come from country 3 and have travelled within days of each other

```{r}
# Time: 16486747 18214747 21152347 24608347 30137947 30224347
df1 %>% filter(Time==16486747)
df1 %>% filter(Time==18214747)
df1 %>% filter(Time==21152347)
df1 %>% filter(Time==24608347)
df1 %>% filter(Time==30137947)
df1 %>% filter(Time==30224347)
```

```{r}
# Weight:1
df1 %>% filter(Weight==1)
df1 %>% filter(Weight==2)
df1 %>% filter(Weight==5)
```

## Procurement Channel:

```{r}
nrow(qt2_23)
qt2_23 <- subset(qt2_23, select = -c(SourceLocation,TargetLocation,SourceLatitude, SourceLongitude, TargetLatitude, TargetLongitude)) # SOurce and Target Latitude and Longitude columns removed as all Null.

qt2_23 %>% distinct(Source, etype, Target, Time, Weight)
nrow(qt2_23)
head(qt2_23)
```

```{r}
unique(qt2_23$Source) 
unique(qt2_23$Target)
```

## 550287(Seller) 512397 (Buyer) 657187 (Item sold)

## Common nodes Analysis:

```{r}
nodes_common = NULL
for (i in qt2_01$Source) {
  for (j in qt2_6$Source) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
for (i in qt2_01$Target) {
  for (j in qt2_6$Target) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
nodes_common #568093 635665 464459
length(nodes_common)
```

```{r}
nodes_common = NULL
for (i in qt2_01$Source) {
  for (j in qt2_4$Source) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
for (i in qt2_01$Target) {
  for (j in qt2_4$Target) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
nodes_common #616050
length(nodes_common)
```

```{r}
nodes_common = NULL
for (i in qt2_01$Source) {
  for (j in qt2_5$Source) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
for (i in qt2_01$Target) {
  for (j in qt2_5$Target) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
nodes_common # 599956 490041 533140 568093 632150 635665 616050 512397 623295 589639 550361 596193 464459 492777 570411 640464 591682 493044
length(nodes_common)
```

```{r}
nodes_common = NULL
for (i in qt2_01$Source) {
  for (j in qt2_23$Source) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
for (i in qt2_01$Target) {
  for (j in qt2_23$Target) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
nodes_common # 512397 550287
length(nodes_common)
```

## Travel Channel:

```{r}
nodes_common = NULL
for (i in qt2_6$Source) {
  for (j in qt2_23$Source) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
for (i in qt2_6$Target) {
  for (j in qt2_23$Target) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
nodes_common #Null
length(nodes_common)
```

```{r}
nodes_common = NULL
for (i in qt2_6$Source) {
  for (j in qt2_4$Source) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
for (i in qt2_6$Target) {
  for (j in qt2_4$Target) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
nodes_common #Null
length(nodes_common)
```


```{r}
nodes_common = NULL
for (i in qt2_6$Source) {
  for (j in qt2_5$Source) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
for (i in qt2_6$Target) {
  for (j in qt2_5$Target) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
nodes_common #464459 568093 635665
length(nodes_common)
```

## Procurement Channel:

```{r}
nodes_common = NULL
for (i in qt2_23$Source) {
  for (j in qt2_4$Source) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
for (i in qt2_23$Target) {
  for (j in qt2_4$Target) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
nodes_common #Null 
length(nodes_common)
```


```{r}
nodes_common = NULL
for (i in qt2_23$Source) {
  for (j in qt2_5$Source) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
for (i in qt2_23$Target) {
  for (j in qt2_5$Target) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
nodes_common #512397
length(nodes_common)
```

# Demographic Channel:

```{r}
nodes_common = NULL
for (i in qt2_4$Source) {
  for (j in qt2_5$Source) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
for (i in qt2_23$Target) {
  for (j in qt2_5$Target) {
    if(i==j){
      nodes_common <- append(nodes_common,i)
      nodes_common <- unique(nodes_common)
    }
    
  }
  
}
nodes_common #616050
length(nodes_common)
```


## Nodes which have travelled only once:

```{r}
count(qt2_6, "Source") #538892,542965,572391 have travelled only once; Not in the common list
```


