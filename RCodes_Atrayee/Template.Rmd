---
title: "TemplateAnalysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
library(plyr)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
# Load The Data:
dt <- data.table::fread(here::here("data", "CGCS-Template.csv"))
head(dt)
tail(dt)

# Summarising the Data:
summary(dt)
nrow(dt)
ncol(dt)

# Differentiating between channels:
dt01 <- dt %>% filter(dt$eType == 0 | dt$eType == 1) # Communication Channel
nrow(dt01) # 563
dt23 <- dt %>% filter(dt$eType == 2 | dt$eType == 3) # Procurement Channel
nrow(dt23) # 18
dt4 <- dt %>% filter(dt$eType == 4) # Co-authorship Channel
nrow(dt4) # 1
dt5 <- dt %>% filter(dt$eType == 5) # Demographic Channel
nrow(dt5) # 591
dt6 <- dt %>% filter(dt$eType == 6) # Travel Channel
nrow(dt6) # 52
# Highest data for Demographic, Communication and Travel Channel.


```

## Travel Channel:

```{r}
glimpse(dt6)
unique(dt6)
unique(dt6$eType) # 6
unique(dt6$SourceLocation) # 3 4 2 1 0 5
unique(dt6$TargetLocation) # 1 3 4 2 0 5
unique(dt6$SourceLatitude) # NA
unique(dt6$SourceLongitude) # NA
unique(dt6$TargetLatitude) # NA
unique(dt6$TargetLongitude) # NA
unique(dt6$Source) #78 80 77 79 82 83 84 73 75 74 39 40 41 87 85 86
unique(dt6$Target) #81 70 69 76 71 72
unique(dt6$Weight) #2 1 3 4 5 6


range(dt6$Source) # 39 87
range(dt6$Target) # 69 81
range(dt6$Time) # 11773606 31004806
range(dt6$Weight) #1 6

hist(dt6$Weight)
unique(dt6$Weight) #2 1 3 4 5 6

```


## Removing Duplicates

```{r}
head(dt6)
dt6 <- subset(dt6, select = -c(SourceLatitude, SourceLongitude, TargetLatitude, TargetLongitude)) # SOurce and Target Latitude and Longitude columns removed as all Null.
dt6 %>% distinct(Source, etype, Target, Time, Weight, SourceLocation, TargetLocation)
nrow(dt6)
# No Duplicate rows in Travel Channel
```

## Each variable with it's Frequency Counts:

```{r}
target_count <- count(dt6, 'Target')
target_count
time_count <- count(dt6, 'Time')
time_count <- time_count %>% filter(time_count$freq > 1)
time_count
weight_count <- count(dt6, 'Weight')
weight_count
sourceloc_count <- count(dt6, 'SourceLocation')
sourceloc_count
targetloc_count <- count(dt6, 'TargetLocation')
targetloc_count
```


## Extracting the top 3 most repeated values from each Column:

```{r}
target <- dt6 %>% filter(Target==71 | Target==70 | Target==69 ) #32 vals; in order: 70,69,71
weight <- dt6 %>% filter(Weight==1 | Weight==2 | Weight==3 ) #39 vals; in order:1,3,2
SLoc <- dt6 %>% filter(SourceLocation==0 | SourceLocation==2 | SourceLocation==3 ) #32; in order: 3,2,0
TLoc <- dt6 %>% filter(TargetLocation==0 | TargetLocation==3 | TargetLocation==4 ) #32; in order: 3,4,0
time <- dt6 %>% filter(Time==15661606 | Time==12292006 | Time==15834406 |Time==24733606 | Time==26634406 | Time==30004006 ) #6 vals; in order: 15661606 (3), 12292006, 15834406, 24733606,26634406, 30004006
df1 <- rbind(target, weight, SLoc, TLoc, time)
nrow(df1)
df1 <- df1[!duplicated(df1), ] # total nodes extracted: 52
nrow(df1)
head(df1)
```


## Target, Time, Weight:


```{r}
# Target:
df1 %>% filter(Target==70) #13 SourceLocation: 0 and 4
df1 %>% filter(Target==70 & SourceLocation==4) #80,77,79,78,39,40,41
df1 %>% filter(Target==70 & SourceLocation==0) #73,75,74,86,87,85

```

### For Target=70, there are 10 nodes out of which:
### 1. 80,77,79,78,39,40,41 come from Country 4
### 2. 73,75,74,86,87,85 come from country 0
### 3. Nodes 80, 77 have travelled to the destination within 2 days of each other and stayed for 1 day
