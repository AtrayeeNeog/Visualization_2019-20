---
title: "Graph1-Analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
# Load The Data:
qt1 <- data.table::fread(here::here("data", "Q1-Graph1.csv"))
head(qt1)
tail(qt1)

```

## Including Plots

You can also embed plots, for example:

```{r}
# Summarising the Data:
summary(qt1)
nrow(qt1) #1216
ncol(qt1) #11

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
# Differentiating between channels:
qt1_01 <- qt1 %>% filter(qt1$eType == 0 | qt1$eType == 1) # Communication Channel
nrow(qt1_01) # 318
qt1_23 <- qt1 %>% filter(qt1$eType == 2 | qt1$eType == 3) # Procurement Channel
nrow(qt1_23) # 14
qt1_4 <- qt1 %>% filter(qt1$eType == 4) # Co-authorship Channel
nrow(qt1_4) # 1
qt1_5 <- qt1 %>% filter(qt1$eType == 5) # Demographic Channel
nrow(qt1_5) # 846
qt1_6 <- qt1 %>% filter(qt1$eType == 6) # Travel Channel
nrow(qt1_6) # 37
```


```{r}
common_list <- NULL
for (i in qt1_01$Source) {
  for (j in qt1_23$Source) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt1_01$Source) {
  for (j in qt1_4$Source) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt1_01$Source) {
  for (j in qt1_5$Source) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt1_01$Source) {
  for (j in qt1_6$Source) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt1_01$Target) {
  for (j in qt1_23$Target) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt1_01$Target) {
  for (j in qt1_4$Target) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt1_01$Target) {
  for (j in qt1_5$Target) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
for (i in qt1_01$Target) {
  for (j in qt1_6$Target) {
    if(i==j){
      common_list <- append(common_list,i)
      common_list <- unique(common_list)
    }
    
  }
  
}
common_list
length(common_list)
```

## Travel Channel:

```{r}
glimpse(qt1_6)
unique(qt1_6)
unique(qt1_6$eType) # 6
unique(qt1_6$SourceLocation) # 4 3 2 1 0 5
unique(qt1_6$TargetLocation) # 3 1 4 2 0 5
unique(qt1_6$SourceLatitude) # 1 -25 -22 -29  33  22
unique(qt1_6$SourceLongitude) # -165 -111   91  -13  -41  156
unique(qt1_6$TargetLatitude) # -25 -29   1 -22  33  22
unique(qt1_6$TargetLongitude) # -111  -13 -165   91  -41  156
unique(qt1_6$Source)
unique(qt1_6$Target)
unique(qt1_6$Weight) #4 2 5 3 1


range(qt1_6$Source) # 464459 649553
range(qt1_6$Target) # 499467 657173
range(qt1_6$Time) # 14845147 30224347
income_cat_qt1 <- NULL


hist(qt1_6$Weight)
unique(qt1_6$Weight) #4 2 5 3 1
range(qt1_6$Weight) #1 5
```

## Removing Duplicates:
```{r}
head(qt1_6)
qt1_6 <- subset(qt1_6, select = -c(SourceLatitude, SourceLongitude, TargetLatitude, TargetLongitude)) # SOurce and Target Latitude and Longitude columns removed as all Null.
qt1_6 %>% distinct(Source, etype, Target, Time, Weight, SourceLocation, TargetLocation)
nrow(qt1_6) #37
# No Duplicate rows in Travel Channel
```

## Each variable with it's Frequency Counts:
```{r}
target_count <- count(qt1_6, 'Target')
target_count #625756 509607 499467 561157 616453 657173
time_count <- count(qt1_6, 'Time')
time_count <- time_count %>% filter(time_count$freq > 1)
time_count #16486747 18214747 21152347 24608347 30137947 30224347
weight_count <- count(qt1_6, 'Weight')
weight_count #2,5,1,4,3
sourceloc_count <- count(qt1_6, 'SourceLocation')
sourceloc_count #3,2,(0,4),1,5
targetloc_count <- count(qt1_6, 'TargetLocation')
targetloc_count #3,4,2,0,1,5
```

## Extracting the top 3 most repeated values from each Column:
```{r}
target <- qt1_6 %>% filter(Target==625756 | Target==509607 | Target==499467 ) #24 vals; 
weight <- qt1_6 %>% filter(Weight==2 | Weight==5 | Weight==1 ) #27 vals; 
SLoc <- qt1_6 %>% filter(SourceLocation==0 | SourceLocation==2 | SourceLocation==3 ) #32; in order: 3,2,0
TLoc <- qt1_6 %>% filter(TargetLocation==3 | TargetLocation==2 | TargetLocation==0 | TargetLocation==4) #30; 
time <- qt1_6 %>% filter(Time==16486747 | Time==18214747 | Time==21152347 |Time==24608347 | Time==30137947 | Time==30224347 ) #12 
df1 <- rbind(target, weight, SLoc, TLoc, time)
nrow(df1)
df1 <- df1[!duplicated(df1), ] # total nodes extracted: 68
nrow(df1)
head(df1)
unique(df1$Source) #29 People
```
